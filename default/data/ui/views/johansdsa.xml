<form>
  <label>Johans DSA</label>
  <search>
    <query>
      | `datamodel("Splunk_Audit", "Datamodel_Acceleration")`
      | rename Datamodel_Acceleration.datamodel AS datamodel, Datamodel_Acceleration.complete AS Acceleration
      | lookup Datamodel_Event_Summary.csv datamodel OUTPUT _time
      | where isnull(_time) OR _time&lt;=relative_time(now(), "-24h")
      | map maxsearches=100 search="| tstats count AS EventCount,dc(host) AS Hosts from datamodel=$datamodel$ WHERE earliest=\"-24h\" | eval datamodel=\"$datamodel$\",Acceleration=\"$Acceleration$\""
      | eval _time=now()
      | outputlookup createinapp=t Datamodel_Event_Summary.csv</query>
    <earliest>-24h@h</earliest>
    <latest>now</latest>
  </search>
  <search id="cs_base">
    <query>
    | rest splunk_server=local count=0 /services/saved/searches 
    | search title!="ESCU - *"
    | where match('action.correlationsearch.enabled', "1|[Tt]|[Tt][Rr][Uu][Ee]")
    | rename eai:acl.app as app, title as csearch_name, action.correlationsearch.label as csearch_label, action.notable.param.security_domain as security_domain
    | rex field=qualifiedSearch ".*datamodel(=|:\"|\(\"|\s|:)(?&lt;datamodel&gt;[a-z,A-Z,_]*)"
    | lookup Datamodel_Event_Summary.csv datamodel
    | eval csearch_label=coalesce(csearch_label,csearch_name)
    | table csearch_label, description,disabled, qualifiedSearch,datamodel, Hosts EventCount 
    | fillnull EventCount Hosts
    | fields *
   </query>
  </search>
  <search id="escu_cs_base">
    <query>
    | rest splunk_server=local count=0 /services/saved/searches 
    | search title="ESCU - *"
    | rename eai:acl.app as app, title as csearch_name, action.correlationsearch.label as csearch_label, action.notable.param.security_domain as security_domain
    | rex field=qualifiedSearch ".*datamodel(=|:\"|\(\"|\s|:)(?&lt;datamodel&gt;[a-z,A-Z,_]*)"
    | lookup Datamodel_Event_Summary.csv datamodel
    | eval csearch_label=coalesce(csearch_label,csearch_name)
    | table csearch_label, description,disabled, qualifiedSearch,datamodel, Hosts EventCount 
    | fillnull EventCount Hosts
    | fields *
   </query>
  </search>
  <init>
    <unset token="display_assets_1"></unset>
    <unset token="display_assets_2"></unset>
    <unset token="display_assets_3"></unset>
    <unset token="display_assets_4"></unset>
    <unset token="display_assets_5"></unset>
  </init>
  <fieldset submitButton="false">
    <input type="time" token="field1" searchWhenChanged="true">
      <label></label>
      <default>
        <earliest>-24h@h</earliest>
        <latest>now</latest>
      </default>
      <change>
        <set token="time_label">$label$</set>
      </change>
    </input>
  </fieldset>
  <row>
    <panel>
      <html>
      <h1>Assets and Hosts- Click to drill down</h1>
    </html>
    </panel>
  </row>
  <row>
    <panel>
      <single>
        <title>Hosts in Asset Inventory</title>
        <search>
          <query>
            | inputlookup append=T asset_lookup_by_str where (dns=* OR nt_host=* OR ip=* OR mac=*) 
            | inputlookup append=t asset_lookup_by_cidr where (dns=* OR nt_host=* OR ip=* OR mac=*) 
            | dedup asset_id
            | stats count
          </query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="drilldown">all</option>
        <option name="refresh.display">progressbar</option>
        <option name="underLabel">In $time_label$</option>
        <drilldown>
          <set token="display_assets_1">1</set>
          <unset token="display_assets_2"></unset>
          <unset token="display_assets_3"></unset>
          <unset token="display_assets_4"></unset>
          <unset token="display_assets_5"></unset>
        </drilldown>
      </single>
    </panel>
    <panel>
      <single>
        <title>Hosts with data</title>
        <search>
          <query>
            | metadata type=hosts 
            | eval _time=lastTime 
            | table host totalCount _time 
            | reltime 
            | sort sourcetype 
            | rename reltime AS "Last Event"
            | timechart span=1d count
            | where _time&gt;=relative_time(now(),"-24h")
          </query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="drilldown">all</option>
        <option name="refresh.display">progressbar</option>
        <option name="underLabel">In $time_label$</option>
        <drilldown>
          <unset token="display_assets_1"></unset>
          <set token="display_assets_2">1</set>
          <unset token="display_assets_3">1</unset>
          <unset token="display_assets_4">1</unset>
          <unset token="display_assets_5">1</unset>
        </drilldown>
      </single>
    </panel>
    <panel>
      <single>
        <title>Hosts in Asset Inventory with data</title>
        <search>
          <query>
            | metadata type=hosts 
            | eval _time=lastTime 
            | table host totalCount _time 
            | reltime 
            | sort sourcetype 
            | rename reltime AS "Last Event"
            | where _time&gt;=relative_time(now(),"-24h")
            | `get_asset(host)`
            | where isnotnull(host_asset_id)
            | stats count
          </query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="drilldown">all</option>
        <option name="refresh.display">progressbar</option>
        <option name="underLabel">In $time_label$</option>
        <drilldown>
          <unset token="display_assets_1"></unset>
          <unset token="display_assets_2"></unset>
          <set token="display_assets_3">1</set>
          <unset token="display_assets_4"></unset>
          <unset token="display_assets_5"></unset>
        </drilldown>
      </single>
    </panel>
    <panel>
      <single>
        <title>Hosts in Asset Inventory with no data</title>
        <search>
          <query>| `assets`
| join asset_id type=outer [
| metadata type=hosts 
| eval _time=lastTime 
| table host totalCount _time 
| reltime 
| sort sourcetype 
| rename reltime AS "Last Event"
| where _time&gt;=relative_time(now(),"-24h")
| `get_asset(host)`
| where isnotnull(host_asset_id)
|rename host_asset_id AS asset_id
| fields asset_id totalCount
]
| where isnull(totalCount)
| stats count</query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="drilldown">all</option>
        <option name="refresh.display">progressbar</option>
        <option name="underLabel">In $time_label$</option>
        <drilldown>
          <unset token="display_assets_1"></unset>
          <unset token="display_assets_2"></unset>
          <unset token="display_assets_3"></unset>
          <set token="display_assets_4">1</set>
          <unset token="display_assets_5"></unset>
        </drilldown>
      </single>
    </panel>
    <panel>
      <single>
        <title>Hosts with data not in Asset Inventory</title>
        <search>
          <query>| metadata type=hosts 
| eval _time=lastTime 
| table host totalCount _time 
| reltime 
| sort sourcetype 
| rename reltime AS "Last Event"
| where _time&gt;=relative_time(now(),"-24h")
| `get_asset(host)`
| where isnull(host_asset_id)
| stats count</query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="drilldown">all</option>
        <option name="refresh.display">progressbar</option>
        <option name="underLabel">In $time_label$</option>
        <drilldown>
          <unset token="display_assets_1"></unset>
          <unset token="display_assets_2"></unset>
          <unset token="display_assets_3"></unset>
          <unset token="display_assets_4"></unset>
          <set token="display_assets_5">1</set>
        </drilldown>
      </single>
    </panel>
  </row>
  <row>
    <panel depends="$display_assets_1$">
      <table>
        <title>Hosts in Asset Inventory</title>
        <search>
          <query>| inputlookup append=T asset_lookup_by_str where (dns=* OR nt_host=* OR ip=* OR mac=*) 
| inputlookup append=t asset_lookup_by_cidr where (dns=* OR nt_host=* OR ip=* OR mac=*) 
| dedup asset_id</query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="count">5</option>
        <option name="drilldown">none</option>
      </table>
    </panel>
    <panel depends="$display_assets_2$">
      <table>
        <title>Hosts with data</title>
        <search>
          <query>| metadata type=hosts 
| eval _time=lastTime 
| table host totalCount _time 
| reltime 
| sort sourcetype 
| rename reltime AS "Last Event"
| where _time&gt;=relative_time(now(),"-24h")</query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="count">5</option>
        <option name="drilldown">none</option>
      </table>
    </panel>
    <panel depends="$display_assets_3$">
      <table>
        <title>Hosts in Asset Inventory with data</title>
        <search>
          <query>| metadata type=hosts 
| eval _time=lastTime 
| table host totalCount _time 
| reltime 
| sort sourcetype 
| rename reltime AS "Last Event"
| where _time&gt;=relative_time(now(),"-24h")
| `get_asset(host)`
| where isnotnull(host_asset_id)</query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="count">5</option>
        <option name="drilldown">none</option>
      </table>
    </panel>
    <panel depends="$display_assets_4$">
      <table>
        <title>Hosts in Asset Inventory with no data</title>
        <search>
          <query>| `assets`
| join asset_id type=outer [
| metadata type=hosts 
| eval _time=lastTime 
| table host totalCount _time 
| reltime 
| sort sourcetype 
| rename reltime AS "Last Event"
| where _time&gt;=relative_time(now(),"-24h")
| `get_asset(host)`
| where isnotnull(host_asset_id)
|rename host_asset_id AS asset_id
| fields asset_id totalCount
]
| where isnull(totalCount)</query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="count">5</option>
        <option name="drilldown">none</option>
      </table>
    </panel>
    <panel depends="$display_assets_5$">
      <table>
        <title>Hosts with data not in Asset Inventory</title>
        <search>
          <query>| metadata type=hosts 
| eval _time=lastTime 
| table host totalCount _time 
| reltime 
| sort sourcetype 
| rename reltime AS "Last Event"
| where _time&gt;=relative_time(now(),"-24h")
| `get_asset(host)`
| where isnull(host_asset_id)</query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="count">5</option>
        <option name="drilldown">none</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <html>
      <h1>Data Models - Click to filter</h1>
    </html>
    </panel>
  </row>
  <row>
    <panel>
      <single>
        <title>Data models</title>
        <search>
          <query>| inputlookup Datamodel_Event_Summary.csv
| stats count</query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="drilldown">all</option>
        <drilldown>
          <set token="form.dm_data">=*</set>
          <set token="form.dm_acc">*</set>
        </drilldown>
      </single>
    </panel>
    <panel>
      <single>
        <title>Data models with data</title>
        <search>
          <query>| inputlookup Datamodel_Event_Summary.csv
          | where EventCount&gt;0
| stats count</query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="drilldown">all</option>
        <option name="underLabel">In $time_label$</option>
        <drilldown>
          <set token="form.dm_data">&gt;0</set>
          <set token="form.dm_acc">*</set>
        </drilldown>
      </single>
    </panel>
    <panel>
      <single>
        <title>Data models with data and acceleration</title>
        <search>
          <query>| inputlookup Datamodel_Event_Summary.csv
          | where EventCount&gt;0 AND Acceleration=1
| stats count</query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="drilldown">all</option>
        <option name="underLabel">In $time_label$</option>
        <drilldown>
          <set token="form.dm_acc">1</set>
          <set token="form.dm_data">&gt;0</set>
        </drilldown>
      </single>
    </panel>
  </row>
  <row>
    <panel>
      <title>Data Models Overview</title>
      <input type="dropdown" token="dm_data">
        <label>Data</label>
        <choice value="=*">Any</choice>
        <choice value="&gt;0">Yes</choice>
        <choice value="=0">No</choice>
        <default>=*</default>
      </input>
      <input type="dropdown" token="dm_acc">
        <label>Acceleration</label>
        <choice value="*">Any</choice>
        <choice value="1">Yes</choice>
        <choice value="0">No</choice>
        <default>*</default>
      </input>
      <table>
        <title>Which data models have data and which sourcetypes, tags and Add-ons are being used to populate the data model.</title>
        <search>
          <query>| rest splunk_server=local count=0 /servicesNS/-/-/admin/datamodel-files 
| spath input=eai:data output=base_search path=objects{}.baseSearch 
| spath input=eai:data output=constraints path=objects{}.constraints{}.search 
| eval tag_content = mvappend(base_search,constraints) 
| rex max_match=0 field=tag_content "tag=\"?(?&lt;tag_name&gt;\w+)\"?" 
| mvexpand tag_name 
| rename title AS datamodel 
| append 
    [| rest splunk_server=local count=0 /servicesNS/-/-/admin/eventtypes 
    | rename eai:acl.app AS app tags AS tag_name 
    | search app="*TA*" 
    | rex max_match=0 field=search "sourcetype=\"?(?&lt;sourcetype&gt;[^\s\"^)]+)\"?" 
    | mvexpand sourcetype 
    | mvexpand tag_name 
    | eval app_sourcetype=mvzip(app,sourcetype,"__") 
    | join sourcetype 
        [ search index=_internal earliest="-24h"
            source=*metrics.log splunk_server="*" group="per_sourcetype_thruput" 
        | eval MB=round(kb/1024,2) 
        | stats sum(MB) AS sumMb by series 
        | rename series as sourcetype 
        | search sourcetype!=_* 
        | sort sumMB 
            ] 
    | stats values(EventCount) AS EventCount,first(Hosts) AS Hosts, values(tag_name) as tag_name by app, sourcetype,app_sourcetype
        ] 
| stats first(Hosts) AS Hosts,sum(EventCount) AS "EventCount",first(totalCount) AS totalCount,list(datamodel) as datamodel, list(app) as app, list(app_sourcetype) as app_sourcetype by tag_name 
| search datamodel=* 
| stats first(Hosts) AS Hosts,sum(EventCount) AS "EventCount",first(totalCount) AS totalCount,values(app_sourcetype) as app_sourcetype, values(tag_name) as tags by datamodel 
| rex max_match=0 field=app_sourcetype "\"?(?&lt;app&gt;.+)__\"?" 
| rex max_match=0 field=app_sourcetype "__\"?(?&lt;sourcetype&gt;.+)\"?" 
| eval tags=mvdedup(tags),app=mvdedup(app) 
| fields - app_sourcetype 
| lookup Datamodel_Event_Summary.csv datamodel
| table datamodel tags sourcetype app Acceleration Hosts EventCount
| search Hosts$dm_data$ AND Acceleration=$dm_acc$
| fillnull Hosts</query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="count">5</option>
        <option name="drilldown">none</option>
        <option name="totalsRow">true</option>
        <format type="color" field="Hosts">
          <colorPalette type="list">[#D93F3C,#65A637]</colorPalette>
          <scale type="threshold">1</scale>
        </format>
        <format type="number" field="EventCount">
          <option name="precision">0</option>
        </format>
        <format type="color" field="Acceleration">
          <colorPalette type="list">[#D93F3C,#65A637]</colorPalette>
          <scale type="threshold">1</scale>
        </format>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <html>
      <h1>Correlation Searches Overview - Click to filter</h1>
    </html>
    </panel>
  </row>
  <row>
    <panel>
      <single>
        <title>Correlation searches</title>
        <search base="cs_base">
          <query>
| stats count</query>
        </search>
        <option name="drilldown">all</option>
        <option name="refresh.display">progressbar</option>
        <drilldown>
          <set token="form.corr_disabled">*</set>
          <set token="form.corr_data">=*</set>
        </drilldown>
      </single>
    </panel>
    <panel>
      <single>
        <title>Enabled Correlation searches</title>
        <search base="cs_base">
          <query>| where disabled=0
| stats count</query>
        </search>
        <option name="drilldown">all</option>
        <drilldown>
          <set token="form.corr_disabled">0</set>
          <set token="form.corr_data">=*</set>
        </drilldown>
        <option name="refresh.display">progressbar</option>
      </single>
    </panel>
    <panel>
      <single>
        <title>Disabled Correlation searches</title>
        <search base="cs_base">
          <query>| where disabled=1
| stats count</query>
        </search>
        <option name="drilldown">all</option>
        <option name="refresh.display">progressbar</option>
        <drilldown>
          <set token="form.corr_disabled">1</set>
          <set token="form.corr_data">=*</set>
        </drilldown>
      </single>
    </panel>
    <panel>
      <single>
        <title>Disabled correlation searches with data</title>
        <search base="cs_base">
          <query>| where disabled=1 AND EventCount&gt;0
| stats count</query>
        </search>
        <option name="drilldown">all</option>
        <option name="underLabel">In $time_label$</option>
        <drilldown>
          <set token="form.corr_disabled">1</set>
          <set token="form.corr_data">&gt;0</set>
        </drilldown>
        <option name="refresh.display">progressbar</option>
      </single>
    </panel>
  </row>
  <row>
    <panel>
      <title>Correlation searches configured in the system and which data models they use.</title>
      <input type="dropdown" token="corr_data">
        <label>Data</label>
        <choice value="=*">Any</choice>
        <choice value="&gt;0">Yes</choice>
        <choice value="=0">No</choice>
        <default>=*</default>
      </input>
      <input type="dropdown" token="corr_disabled">
        <label>Enabled</label>
        <choice value="*">Any</choice>
        <choice value="0">Yes</choice>
        <choice value="1">No</choice>
        <default>*</default>
      </input>
      <table>
        <search base="cs_base">
          <query>| table csearch_label, description, qualifiedSearch,disabled,datamodel Hosts EventCount
          | search disabled=$corr_disabled$ Hosts$corr_data$
          </query>
        </search>
        <option name="count">5</option>
        <option name="drilldown">none</option>
        <option name="totalsRow">true</option>
        <format type="number" field="EventCount">
          <option name="precision">0</option>
        </format>
        <format type="color" field="EventCount">
          <colorPalette type="list">[#D93F3C,#65A637]</colorPalette>
          <scale type="threshold">1</scale>
        </format>
        <format type="color" field="disabled">
          <colorPalette type="list">[#65A637,#D93F3C]</colorPalette>
          <scale type="threshold">1</scale>
        </format>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <html>
      <h1>Enterprise Security Content Updates (ESCU) - Correlation Searches Overview - Click to filter</h1>
    </html>
    </panel>
  </row>
  <row>
    <panel>
      <single>
        <title>ESCU Correlation searches</title>
        <search base="escu_cs_base">
          <query>
| stats count</query>
        </search>
        <option name="drilldown">all</option>
        <option name="refresh.display">progressbar</option>
        <drilldown>
          <set token="form.escu_corr_disabled">*</set>
          <set token="form.escu_corr_data">=*</set>
        </drilldown>
      </single>
    </panel>
    <panel>
      <single>
        <title>Enabled ESCU Correlation searches</title>
        <search base="escu_cs_base">
          <query>| where disabled=0
| stats count</query>
        </search>
        <option name="drilldown">all</option>
        <option name="refresh.display">progressbar</option>
        <drilldown>
          <set token="form.escu_corr_disabled">0</set>
          <set token="form.escu_corr_data">=*</set>
        </drilldown>
      </single>
    </panel>
    <panel>
      <single>
        <title>Disabled ESCU Correlation searches</title>
        <search base="escu_cs_base">
          <query>| where disabled=1
| stats count</query>
        </search>
        <option name="drilldown">all</option>
        <option name="refresh.display">progressbar</option>
        <drilldown>
          <set token="form.escu_corr_disabled">1</set>
          <set token="form.escu_corr_data">=*</set>
        </drilldown>
      </single>
    </panel>
    <panel>
      <single>
        <title>Disabled ESCU Correlation searches with data</title>
        <search base="escu_cs_base">
          <query>| where disabled=1 AND EventCount&gt;0
| stats count</query>
        </search>
        <option name="drilldown">all</option>
        <option name="refresh.display">progressbar</option>
        <option name="underLabel">In $time_label$</option>
        <drilldown>
          <set token="form.escu_corr_disabled">1</set>
          <set token="form.escu_corr_data">&gt;0</set>
        </drilldown>
      </single>
    </panel>
  </row>
  <row>
    <panel>
      <title>Correlation searches configured in the system and which data models they use.</title>
      <input type="dropdown" token="escu_corr_data">
        <label>Data</label>
        <choice value="=*">Any</choice>
        <choice value="&gt;0">Yes</choice>
        <choice value="=0">No</choice>
        <default>=*</default>
      </input>
      <input type="dropdown" token="escu_corr_disabled">
        <label>Enabled</label>
        <choice value="*">Any</choice>
        <choice value="0">Yes</choice>
        <choice value="1">No</choice>
        <default>*</default>
      </input>
      <table>
        <search base="escu_cs_base">
          <query>| table csearch_label, description, qualifiedSearch,disabled,datamodel Hosts EventCount
          | search disabled=$escu_corr_disabled$ Hosts$escu_corr_data$
          </query>
        </search>
        <option name="count">5</option>
        <option name="drilldown">none</option>
        <option name="totalsRow">true</option>
        <format type="number" field="EventCount">
          <option name="precision">0</option>
        </format>
        <format type="color" field="EventCount">
          <colorPalette type="list">[#D93F3C,#65A637]</colorPalette>
          <scale type="threshold">1</scale>
        </format>
        <format type="color" field="disabled">
          <colorPalette type="list">[#65A637,#D93F3C]</colorPalette>
          <scale type="threshold">1</scale>
        </format>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <html>
      <h1>Sourcetypes</h1>
    </html>
    </panel>
  </row>
  <row>
    <panel>
      <title>Data Sources Over Time in $time_label$ - Click to drilldown to search</title>
      <chart>
        <search>
          <query>| tstats count WHERE index=* GROUPBY sourcetype, _time | timechart limit=20 sum(count) by sourcetype</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
          <sampleRatio>1</sampleRatio>
        </search>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.abbreviation">none</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.abbreviation">none</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.abbreviation">none</option>
        <option name="charting.axisY2.enabled">0</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">column</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.showDataLabels">none</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">stacked</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.layout.splitSeries.allowIndependentYRanges">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.mode">standard</option>
        <option name="charting.legend.placement">right</option>
        <option name="charting.lineWidth">2</option>
        <option name="refresh.display">progressbar</option>
        <option name="trellis.enabled">0</option>
        <option name="trellis.scales.shared">1</option>
        <option name="trellis.size">medium</option>
        <drilldown>
          <link target="_blank">search?q=sourcetype=$click.name2$&amp;earliest=$field1.earliest$&amp;latest=$field1.latest$</link>
        </drilldown>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <title>Date Source Overview in $time_label$- Click to drilldown to search</title>
      <table>
        <search>
          <query>| metadata type=sourcetypes | eval _time=lastTime | table sourcetype  totalCount _time | reltime | sort sourcetype | rename reltime AS "Last Event"</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
          <sampleRatio>1</sampleRatio>
        </search>
        <option name="count">20</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">cell</option>
        <option name="percentagesRow">false</option>
        <option name="refresh.display">progressbar</option>
        <option name="rowNumbers">false</option>
        <option name="totalsRow">false</option>
        <option name="wrap">true</option>
        <drilldown>
          <link target="_blank">search?q=sourcetype="$row.sourcetype$"&amp;earliest=$field1.earliest$&amp;latest=$field1.latest$</link>
        </drilldown>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <table>
        <title>Sourcetypes, Indexing and count of Hosts in $time_label$</title>
        <search>
          <query>index=_internal 
source=*metrics.log splunk_server="*" group="per_sourcetype_thruput" earliest="-24h"
| eval MB=round(kb/1024,2) 
| stats sum(MB) by series 
| rename series as sourcetype 
| search sourcetype!=_* 
| sort sum(MB) 
| join sourcetype type=outer 
    [| tstats count WHERE index=* earliest="-24h" GROUPBY sourcetype,host
    | stats dc(host) as Hosts by sourcetype 
    | eval sourcetype=lower(sourcetype)] 
| eval MBPerHost=round('sum(MB)'/Hosts,0)
| sort -"sum(MB)"</query>
          <earliest>$field1.earliest$</earliest>
          <latest>$field1.latest$</latest>
        </search>
        <option name="count">10</option>
        <option name="drilldown">none</option>
        <option name="totalsRow">true</option>
      </table>
    </panel>
  </row>
</form>
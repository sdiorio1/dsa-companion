<dashboard theme="dark">
  <label>Content Inventory</label>
  <row>
    <panel>
      <single>
        <title>ES Correlation Searches</title>
        <search>
          <query>| rest splunk_server=local count=0 /services/saved/searches 
| where match('action.correlationsearch.enabled', "1|[Tt]|[Tt][Rr][Uu][Ee]") 
| search title!="ESCU - *"
| rename eai:acl.app as app, title as csearch_name, action.correlationsearch.label as csearch_label, action.notable.param.security_domain as security_domain 
| rex field=qualifiedSearch ".*datamodel(=|:\"|\(\"|\s|:)(?&lt;datamodel&gt;[a-z,A-Z,_]*)"
| table csearch_label, description, datamodel
| stats count</query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="drilldown">all</option>
        <option name="refresh.display">progressbar</option>
        <drilldown>
          <link target="_blank">search?q=%7C%20rest%20splunk_server=local%20count=0%20/services/saved/searches%20%0A%7C%20where%20match('action.correlationsearch.enabled',%20%221%7C%5BTt%5D%7C%5BTt%5D%5BRr%5D%5BUu%5D%5BEe%5D%22)%20%0A%7C%20search%20title!=%22ESCU%20-%20*%22%0A%7C%20rename%20eai:acl.app%20as%20app,%20title%20as%20csearch_name,%20action.correlationsearch.label%20as%20csearch_label,%20action.notable.param.security_domain%20as%20security_domain%20%0A%7C%20rex%20field=qualifiedSearch%20%22.*datamodel(=%7C:%5C%22%7C%5C(%5C%22%7C%5Cs%7C:)(?%3Cdatamodel%3E%5Ba-z,A-Z,_%5D*)%22%0A%7C%20table%20csearch_label,%20description,%20datamodel&amp;earliest=-24h@h&amp;latest=now</link>
        </drilldown>
      </single>
    </panel>
    <panel>
      <single>
        <title>ES Content Update</title>
        <search>
          <query>| rest /services/configs/conf-analytic_stories splunk_server=local count=0
| eval datamodels = replace(data_models, "[\[\]\"]", "")
| table title description datamodels
| stats count</query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="drilldown">all</option>
        <drilldown>
          <link target="_blank">search?q=%7C%20rest%20/services/configs/conf-analytic_stories%20splunk_server=local%20count=0%0A%7C%20eval%20datamodels%20=%20replace(data_models,%20%22%5B%5C%5B%5C%5D%5C%22%5D%22,%20%22%22)%0A%7C%20table%20title%20description%20datamodels&amp;earliest=-24h@h&amp;latest=now</link>
        </drilldown>
      </single>
    </panel>
  </row>
  <row>
    <panel>
      <title>Data Sources</title>
      <table>
        <search>
          <query>index=_internal source=*license_usage.log TERM(type=Usage) earliest=-7d@d latest=@d
| fields idx, b, st, h, _time, date_wday
| eval h=if(len(h)=0 OR isnull(h),"(SQUASHED)",h)
| bin _time span=1d
| stats sum(b) AS b, dc(h) AS h by st idx date_wday
| stats avg(b) as avg_b, avg(h) AS Host_Count_per_Day by idx st
| eval Avg_MB_per_Day=round(avg_b/1024/1024,2)
| eval Avg_GB_per_Day=round(avg_b/1024/1024/1024,2)
| eval Avg_MB_per_Host=round(Avg_MB_per_Day/Host_Count_per_Day,2)
| eval Host_Count_per_Day=round(Host_Count_per_Day,0)
| rename st AS Sourcetype
| table idx, Sourcetype, Avg_MB_per_Day, Avg_GB_per_Day, Host_Count_per_Day, Avg_MB_per_Host
| sort Sourcetype</query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="count">15</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">none</option>
      </table>
    </panel>
  </row>
</dashboard>
<dashboard theme="dark">
  <label>Content Inventory</label>
  <description>Please install the Apps: ES, ESCU, Security Essentials</description>
  <row>
    <panel>
      <single>
        <title>All</title>
        <search>
          <query>| rest splunk_server=local count=0 /services/saved/searches 
| search action.correlationsearch.enabled = "1"
| search title!="ESCU - *"
| rename eai:acl.app as app, action.correlationsearch.label as title, action.notable.param.security_domain as security_domain 
| rex field=qualifiedSearch ".*datamodel(=\"|=|:\"|\(\"|\s|:)(?&lt;datamodel&gt;[a-z,A-Z,_]*)"
| eval source="ES", detection_searches=title
| nomv datamodel | nomv providing_technologies | nomv security_domain | nomv category | nomv use_case | nomv mitre | nomv killchain | nomv detection_searches | nomv investigative_searches | nomv contextual_searches | nomv support_searches | nomv qualifiedSearch
| eval datamodel = replace(datamodel, "\n", " | ") | eval providing_technologies = replace(providing_technologies, "\n", " | ") | eval security_domain = replace(security_domain, "\n", " | ") | eval category = replace(category, "\n", " | ") | eval use_case = replace(use_case, "\n", " | ") | eval mitre = replace(mitre, "\n", " | ") | eval killchain = replace(killchain, "\n", " | ") | eval detection_searches = replace(detection_searches, "\n", " | ") | eval investigative_searches = replace(investigative_searches, "\n", " | ") | eval contextual_searches = replace(contextual_searches, "\n", " | ") | eval support_searches = replace(support_searches, "\n", " | ")  | eval qualifiedSearch = replace(qualifiedSearch, "\n", " | ")
| sort title

| append [
| rest /services/configs/conf-analytic_stories splunk_server=local count=0
| eval datamodels = replace(data_models, "[\[\]\"]", "") 
| eval providing_technologies = replace(providing_technologies, "[\[\]\"]", "")
| eval detection_searches = replace(detection_searches, "[\[\]\"]", "") 
| eval support_searches = replace(support_searches, "[\[\]\"]", "") 
| eval investigative_searches = replace(investigative_searches, "[\[\]\"]", "") 
| eval contextual_searches = replace(contextual_searches, "[\[\]\"]", "") 
| eval providing_technologies = replace(providing_technologies, ",", " |")
| eval description = replace(description, ",", "")
| eval detection_searches = replace(detection_searches, ",", " |")
| eval support_searches = replace(support_searches, ",", " |")
| eval investigative_searches = replace(investigative_searches, ",", " |")
| eval contextual_searches = replace(contextual_searches, ",", " |")
| eval datamodels = replace(datamodels, ",", " |")
| spath input=mappings path=kill_chain_phases{} output="killchain"
| spath input=mappings path=mitre_attack{} output="mitre"
| nomv mitre | nomv killchain
| eval mitre = replace(mitre, "\n", " | ")
| eval killchain = replace(killchain, "\n", " | ")
| rename eai:acl.app as app
| eval source="ESCU Analytic Stories"
| nomv datamodel | nomv providing_technologies | nomv security_domain | nomv category | nomv use_case | nomv mitre | nomv killchain | nomv detection_searches | nomv investigative_searches | nomv contextual_searches | nomv support_searches | nomv qualifiedSearch
| eval datamodel = replace(datamodel, "\n", " | ") | eval providing_technologies = replace(providing_technologies, "\n", " | ") | eval security_domain = replace(security_domain, "\n", " | ") | eval category = replace(category, "\n", " | ") | eval use_case = replace(use_case, "\n", " | ") | eval mitre = replace(mitre, "\n", " | ") | eval killchain = replace(killchain, "\n", " | ") | eval detection_searches = replace(detection_searches, "\n", " | ") | eval investigative_searches = replace(investigative_searches, "\n", " | ") | eval contextual_searches = replace(contextual_searches, "\n", " | ") | eval support_searches = replace(support_searches, "\n", " | ") | eval qualifiedSearch = replace(qualifiedSearch, "\n", " | ")
| sort title
]

| append [
| rest splunk_server=local count=0 /services/saved/searches 
| search action.correlationsearch.enabled = "1"
| search title="ESCU - *"
| rename eai:acl.app as app, action.correlationsearch.label as title, action.notable.param.security_domain as security_domain 
| rex field=qualifiedSearch ".*datamodel(=\"|=|:\"|\(\"|\s|:)(?&lt;datamodel&gt;[a-z,A-Z,_]*)"
| eval description = replace(description, ",", "")
| eval source="ESCU Searches"
| nomv datamodel | nomv providing_technologies | nomv security_domain | nomv category | nomv use_case | nomv mitre | nomv killchain | nomv detection_searches | nomv investigative_searches | nomv contextual_searches | nomv support_searches | nomv qualifiedSearch
| eval datamodel = replace(datamodel, "\n", " | ") | eval providing_technologies = replace(providing_technologies, "\n", " | ") | eval security_domain = replace(security_domain, "\n", " | ") | eval category = replace(category, "\n", " | ") | eval use_case = replace(use_case, "\n", " | ") | eval mitre = replace(mitre, "\n", " | ") | eval killchain = replace(killchain, "\n", " | ") | eval detection_searches = replace(detection_searches, "\n", " | ") | eval investigative_searches = replace(investigative_searches, "\n", " | ") | eval contextual_searches = replace(contextual_searches, "\n", " | ") | eval support_searches = replace(support_searches, "\n", " | ") | eval qualifiedSearch = replace(qualifiedSearch, "\n", " | ")
| sort title
]

| append [
| sseanalytics
| eval source="Security Essentials" 
| search hasSearch="Yes" app="Splunk_Security_Essentials"
| rename datasource as providing_technologies domain as security_domain mitre_technique_display as mitre usecase as use_case name as title
| eval description = replace(description, "[&lt;p&gt;,&lt;/p&gt;,&lt;b&gt;,&lt;/b&gt;]","")
| nomv datamodel | nomv providing_technologies | nomv security_domain | nomv category | nomv use_case | nomv mitre | nomv killchain | nomv detection_searches | nomv investigative_searches | nomv contextual_searches | nomv support_searches | nomv qualifiedSearch
| eval datamodel = replace(datamodel, "\n", " | ") | eval providing_technologies = replace(providing_technologies, "\n", " | ") | eval security_domain = replace(security_domain, "\n", " | ") | eval category = replace(category, "\n", " | ") | eval use_case = replace(use_case, "\n", " | ") | eval mitre = replace(mitre, "\n", " | ") | eval killchain = replace(killchain, "\n", " | ") | eval detection_searches = replace(detection_searches, "\n", " | ") | eval investigative_searches = replace(investigative_searches, "\n", " | ") | eval contextual_searches = replace(contextual_searches, "\n", " | ") | eval support_searches = replace(support_searches, "\n", " | ") | eval qualifiedSearch = replace(qualifiedSearch, "\n", " | ")
| sort title
]

| append [
| sseanalytics
| eval source="UBA" 
| search app="Splunk_User_Behavior_Analytics"
| rename datasource as providing_technologies domain as security_domain mitre_technique_display as mitre usecase as use_case name as title
| nomv datamodel | nomv providing_technologies | nomv security_domain | nomv category | nomv use_case | nomv mitre | nomv killchain | nomv detection_searches | nomv investigative_searches | nomv contextual_searches | nomv support_searches | nomv qualifiedSearch
| eval datamodel = replace(datamodel, "\n", " | ") | eval providing_technologies = replace(providing_technologies, "\n", " | ") | eval security_domain = replace(security_domain, "\n", " | ") | eval category = replace(category, "\n", " | ") | eval use_case = replace(use_case, "\n", " | ") | eval mitre = replace(mitre, "\n", " | ") | eval killchain = replace(killchain, "\n", " | ") | eval detection_searches = replace(detection_searches, "\n", " | ") | eval investigative_searches = replace(investigative_searches, "\n", " | ") | eval contextual_searches = replace(contextual_searches, "\n", " | ") | eval support_searches = replace(support_searches, "\n", " | ") | eval qualifiedSearch = replace(qualifiedSearch, "\n", " | ")
| sort title
]

| table source, app, title, description, datamodel, providing_technologies, security_domain, category, use_case, mitre, killchain, detection_searches, investigative_searches, contextual_searches, support_searches, qualifiedSearch
| sort source
| outputlookup dsa_all.csv
| stats count</query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
      </single>
    </panel>
  </row>
  <row>
    <panel>
      <single>
        <title>ES Correlation Searches</title>
        <search>
          <query>| rest splunk_server=local count=0 /services/saved/searches 
| search action.correlationsearch.enabled = "1"
| search title!="ESCU - *"
| rename eai:acl.app as app, action.correlationsearch.label as title, action.notable.param.security_domain as security_domain 
| rex field=qualifiedSearch ".*datamodel(=\"|=|:\"|\(\"|\s|:)(?&lt;datamodel&gt;[a-z,A-Z,_]*)"
| eval source="ES", detection_searches=title
| nomv datamodel | nomv providing_technologies | nomv security_domain | nomv category | nomv use_case | nomv mitre | nomv killchain | nomv detection_searches | nomv investigative_searches | nomv contextual_searches | nomv support_searches | nomv qualifiedSearch
| eval datamodel = replace(datamodel, "\n", " | ") | eval providing_technologies = replace(providing_technologies, "\n", " | ") | eval security_domain = replace(security_domain, "\n", " | ") | eval category = replace(category, "\n", " | ") | eval use_case = replace(use_case, "\n", " | ") | eval mitre = replace(mitre, "\n", " | ") | eval killchain = replace(killchain, "\n", " | ") | eval detection_searches = replace(detection_searches, "\n", " | ") | eval investigative_searches = replace(investigative_searches, "\n", " | ") | eval contextual_searches = replace(contextual_searches, "\n", " | ") | eval support_searches = replace(support_searches, "\n", " | ") | eval qualifiedSearch = replace(qualifiedSearch, "\n", " | ")
| table source, app, title, description, datamodel, providing_technologies, security_domain, category, use_case, mitre, killchain, detection_searches, investigative_searches, contextual_searches, support_searches, qualifiedSearch
| sort title
| outputlookup dsa_es_searches.csv
| stats count</query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
      </single>
    </panel>
    <panel>
      <single>
        <title>ESCU Analytic Stories</title>
        <search>
          <query>| rest /services/configs/conf-analytic_stories splunk_server=local count=0
| eval datamodels = replace(data_models, "[\[\]\"]", "") 
| eval providing_technologies = replace(providing_technologies, "[\[\]\"]", "")
| eval detection_searches = replace(detection_searches, "[\[\]\"]", "") 
| eval support_searches = replace(support_searches, "[\[\]\"]", "") 
| eval investigative_searches = replace(investigative_searches, "[\[\]\"]", "") 
| eval contextual_searches = replace(contextual_searches, "[\[\]\"]", "") 
| eval providing_technologies = replace(providing_technologies, ",", " |")
| eval description = replace(description, ",", "")
| eval detection_searches = replace(detection_searches, ",", " |")
| eval support_searches = replace(support_searches, ",", " |")
| eval investigative_searches = replace(investigative_searches, ",", " |")
| eval contextual_searches = replace(contextual_searches, ",", " |")
| eval datamodels = replace(datamodels, ",", " |")
| spath input=mappings path=kill_chain_phases{} output="killchain"
| spath input=mappings path=mitre_attack{} output="mitre"
| nomv mitre | nomv killchain
| eval mitre = replace(mitre, "\n", " | ")
| eval killchain = replace(killchain, "\n", " | ")
| rename eai:acl.app as app
| eval source="ESCU Analytic Stories"
| nomv datamodel | nomv providing_technologies | nomv security_domain | nomv category | nomv use_case | nomv mitre | nomv killchain | nomv detection_searches | nomv investigative_searches | nomv contextual_searches | nomv support_searches | nomv qualifiedSearch
| eval datamodel = replace(datamodel, "\n", " | ") | eval providing_technologies = replace(providing_technologies, "\n", " | ") | eval security_domain = replace(security_domain, "\n", " | ") | eval category = replace(category, "\n", " | ") | eval use_case = replace(use_case, "\n", " | ") | eval mitre = replace(mitre, "\n", " | ") | eval killchain = replace(killchain, "\n", " | ") | eval detection_searches = replace(detection_searches, "\n", " | ") | eval investigative_searches = replace(investigative_searches, "\n", " | ") | eval contextual_searches = replace(contextual_searches, "\n", " | ") | eval support_searches = replace(support_searches, "\n", " | ") | eval qualifiedSearch = replace(qualifiedSearch, "\n", " | ")
| table source, app, title, description, datamodel, providing_technologies, security_domain, category, use_case, mitre, killchain, detection_searches, investigative_searches, contextual_searches, support_searches, qualifiedSearch
| sort title
| outputlookup dsa_escu_analyticStories.csv
| stats count</query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
      </single>
    </panel>
    <panel>
      <single>
        <title>ESCU Searches</title>
        <search>
          <query>| rest splunk_server=local count=0 /services/saved/searches 
| search action.correlationsearch.enabled = "1"
| search title="ESCU - *"
| rename eai:acl.app as app, action.correlationsearch.label as title, action.notable.param.security_domain as security_domain 
| rex field=qualifiedSearch ".*datamodel(=\"|=|:\"|\(\"|\s|:)(?&lt;datamodel&gt;[a-z,A-Z,_]*)"
| eval description = replace(description, ",", "")
| eval source="ESCU Searches"
| nomv datamodel | nomv providing_technologies | nomv security_domain | nomv category | nomv use_case | nomv mitre | nomv killchain | nomv detection_searches | nomv investigative_searches | nomv contextual_searches | nomv support_searches | nomv qualifiedSearch
| eval datamodel = replace(datamodel, "\n", " | ") | eval providing_technologies = replace(providing_technologies, "\n", " | ") | eval security_domain = replace(security_domain, "\n", " | ") | eval category = replace(category, "\n", " | ") | eval use_case = replace(use_case, "\n", " | ") | eval mitre = replace(mitre, "\n", " | ") | eval killchain = replace(killchain, "\n", " | ") | eval detection_searches = replace(detection_searches, "\n", " | ") | eval investigative_searches = replace(investigative_searches, "\n", " | ") | eval contextual_searches = replace(contextual_searches, "\n", " | ") | eval support_searches = replace(support_searches, "\n", " | ") | eval qualifiedSearch = replace(qualifiedSearch, "\n", " | ")
| table source, app, title, description, datamodel, providing_technologies, security_domain, category, use_case, mitre, killchain, detection_searches, investigative_searches, contextual_searches, support_searches, qualifiedSearch
| sort title
| outputlookup dsa_escu_searches.csv
| stats count</query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
      </single>
    </panel>
    <panel>
      <single>
        <title>Security Essentials</title>
        <search>
          <query>| sseanalytics
| eval source="Security Essentials" 
| search hasSearch="Yes" app="Splunk_Security_Essentials"
| rename datasource as providing_technologies domain as security_domain mitre_technique_display as mitre usecase as use_case name as title
| eval description = replace(description, "[&lt;p&gt;,&lt;/p&gt;,&lt;b&gt;,&lt;/b&gt;]","")
| nomv datamodel | nomv providing_technologies | nomv security_domain | nomv category | nomv use_case | nomv mitre | nomv killchain | nomv detection_searches | nomv investigative_searches | nomv contextual_searches | nomv support_searches | nomv qualifiedSearch
| eval datamodel = replace(datamodel, "\n", " | ") | eval providing_technologies = replace(providing_technologies, "\n", " | ") | eval security_domain = replace(security_domain, "\n", " | ") | eval category = replace(category, "\n", " | ") | eval use_case = replace(use_case, "\n", " | ") | eval mitre = replace(mitre, "\n", " | ") | eval killchain = replace(killchain, "\n", " | ") | eval detection_searches = replace(detection_searches, "\n", " | ") | eval investigative_searches = replace(investigative_searches, "\n", " | ") | eval contextual_searches = replace(contextual_searches, "\n", " | ") | eval support_searches = replace(support_searches, "\n", " | ") | eval qualifiedSearch = replace(qualifiedSearch, "\n", " | ")
| sort title
| table source, app, title, description, datamodel, providing_technologies, security_domain, category, use_case, mitre, killchain, detection_searches, investigative_searches, contextual_searches, support_searches, qualifiedSearch
| outputlookup dsa_sse_searches.csv
| stats count</query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
      </single>
    </panel>
    <panel>
      <single>
        <title>UBA</title>
        <search>
          <query>| sseanalytics
| eval source="UBA" 
| search app="Splunk_User_Behavior_Analytics"
| rename datasource as providing_technologies domain as security_domain mitre_technique_display as mitre usecase as use_case name as title
| nomv datamodel | nomv providing_technologies | nomv security_domain | nomv category | nomv use_case | nomv mitre | nomv killchain | nomv detection_searches | nomv investigative_searches | nomv contextual_searches | nomv support_searches | nomv qualifiedSearch
| eval datamodel = replace(datamodel, "\n", " | ") | eval providing_technologies = replace(providing_technologies, "\n", " | ") | eval security_domain = replace(security_domain, "\n", " | ") | eval category = replace(category, "\n", " | ") | eval use_case = replace(use_case, "\n", " | ") | eval mitre = replace(mitre, "\n", " | ") | eval killchain = replace(killchain, "\n", " | ") | eval detection_searches = replace(detection_searches, "\n", " | ") | eval investigative_searches = replace(investigative_searches, "\n", " | ") | eval contextual_searches = replace(contextual_searches, "\n", " | ") | eval support_searches = replace(support_searches, "\n", " | ") | eval qualifiedSearch = replace(qualifiedSearch, "\n", " | ")
| sort title
| outputlookup dsa_sse_searches.csv
| stats count</query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
      </single>
    </panel>
  </row>
</dashboard>